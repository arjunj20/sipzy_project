{% extends 'base.html' %}
{% load static %}

{% block title %}Sign In - Sipzy{% endblock %}

{% block content %}
<section class="flex flex-col md:flex-row justify-center items-center py-12 px-6 bg-[#F8F9FA]">
  <div class="bg-white rounded-2xl shadow-md flex flex-col md:flex-row w-full max-w-4xl overflow-hidden">

    <!-- Left illustration -->
    <div class="bg-[#F8F9FA] flex justify-center items-center p-8 md:w-1/2">
      <img src="{% static 'images/illu 1.png' %}" alt="Bottle Illustration" class="w-64 md:w-72 h-auto">
    </div>

    <!-- Right Login Form -->
    <div class="md:w-1/2 bg-[#F8F9FA] flex flex-col justify-center items-center p-10">
      <h2 class="text-3xl font-semibold text-[#000] mb-6">SIGN IN</h2>
<form method="POST" class="w-full max-w-sm space-y-4" onsubmit="return validateLogin()">
    {% csrf_token %}

    <!-- Email -->
    <div>
        <input type="email" id="email" name="email" placeholder="Email"
            class="w-full p-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-[#B7472A]"
            value="{{ request.POST.email }}">
        
        <p id="email_error" class="text-red-500 text-sm mt-1"></p>

        {% if errors.email %}
        <p class="text-red-500 text-sm">{{ errors.email }}</p>
        {% endif %}
        {% if errors.email_format %}
        <p class="text-red-500 text-sm">{{ errors.email_format }}</p>
        {% endif %}
    </div>

    <!-- Password -->
    <div>
        <input type="password" id="password" name="password" placeholder="Password"
            class="w-full p-3 rounded-md border border-gray-300 focus:ring-2 focus:ring-[#B7472A]">
        
        <p id="password_error" class="text-red-500 text-sm mt-1"></p>
        {% if errors.password %}
        <p class="text-red-500 text-sm">{{ errors.password }}</p>
        {% endif %}
    </div>

    {% if errors.invalid %}
    <p class="text-red-500 text-sm mt-1">{{ errors.invalid }}</p>
    {% endif %}

    {% if errors.inactive %}
    <p class="text-red-500 text-sm mt-1">{{ errors.inactive }}</p>
    {% endif %}

    {% if errors.locked %}
    <p class="text-red-500 text-sm mt-1">{{ errors.locked }}</p>
    {% endif %}

    {% if errors.attempts_left %}
    <p class="text-red-500 text-sm mt-1">{{ errors.attempts_left }}</p>
    {% endif %}

    <button type="submit"
        class="w-full bg-black text-white py-3 rounded-md hover:bg-gray-800 transition">
        Submit
    </button>
</form>




      <!-- Divider -->
      <div class="mt-5 text-gray-500 text-sm">OR</div>

      <!-- Google Login -->
   {% load socialaccount %}
<a href="{% provider_login_url 'google' %}"
   class="mt-3 flex items-center justify-center border border-gray-300 rounded-md px-4 py-2 hover:bg-gray-100 transition w-full max-w-sm">
    <img src="{% static 'images/Google.png' %}" alt="Google Icon" class="h-5 mr-2">
    Login with Google
</a>


      <!-- Signup link -->
      <p class="mt-5 text-gray-600 text-sm">
        Don't have an account?
        <a href="{% url 'user_signup' %}" class="text-[#B7472A] font-medium hover:underline">Signup</a>
      </p>

      <!-- Forgot password -->
  <a href="{% url 'forgot_password' %}" 
   class="mt-2 text-gray-600 text-sm hover:underline cursor-pointer block">
   Forgot Password?
</a>

    </div>
  </div>
</section>
<script>
function validateLogin() {
    let email = document.getElementById("email").value.trim();
    let password = document.getElementById("password").value.trim();

    // Clear old errors
    document.getElementById("email_error").textContent = "";
    document.getElementById("password_error").textContent = "";

    let isValid = true;

    // Email validation
    if (email === "") {
        document.getElementById("email_error").textContent = "Email is required.";
        isValid = false;
    } 
    else if (!/^\S+@\S+\.\S+$/.test(email)) {
        document.getElementById("email_error").textContent = "Enter a valid email.";
        isValid = false;
    }

    // Password validation
    if (password === "") {
        document.getElementById("password_error").textContent = "Password is required.";
        isValid = false;
    }

    // Prevent form submitting if false
    return isValid;
}
</script>

{% endblock %}
